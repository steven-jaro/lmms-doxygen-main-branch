<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LMMS: LV2_MIDI Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LMMS
   </div>
   <div id="projectbrief">Linux MultiMedia Studio - Complete Codebase</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('structLV2__MIDI.html','','structLV2__MIDI-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">LV2_MIDI Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="lv2-miditype_8h_source.html">lv2-miditype.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for LV2_MIDI:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="structLV2__MIDI__coll__graph.svg" width="106" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-attribs" class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a02c6e454062553934a117206ea56380a" id="r_a02c6e454062553934a117206ea56380a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mid_8cpp.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a02c6e454062553934a117206ea56380a">event_count</a></td></tr>
<tr class="memitem:aa562b79a14e26f697116bf2d8494ff46" id="r_aa562b79a14e26f697116bf2d8494ff46"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mid_8cpp.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa562b79a14e26f697116bf2d8494ff46">capacity</a></td></tr>
<tr class="memitem:a6e8c8c7ef09bf292039f8d8833146277" id="r_a6e8c8c7ef09bf292039f8d8833146277"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mid_8cpp.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e8c8c7ef09bf292039f8d8833146277">size</a></td></tr>
<tr class="memitem:a1f81a74b778729832fd478a268c56682" id="r_a1f81a74b778729832fd478a268c56682"><td class="memItemLeft" align="right" valign="top">unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f81a74b778729832fd478a268c56682">data</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This data structure is used to contain the MIDI events for one run() cycle. The port buffer for a LV2 port that has the datatype <a href="http://ll-plugins.nongnu.org/lv2/ext/miditype">http://ll-plugins.nongnu.org/lv2/ext/miditype</a> should be a pointer to an instance of this struct.</p>
<p>To store two Note On events on MIDI channel 0 in a buffer, with timestamps 12 and 35.5, you could use something like this code (assuming that midi_data is a variable of type <a class="el" href="structLV2__MIDI.html">LV2_MIDI</a>): </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> buffer_offset = 0;</div>
<div class="line">*(<span class="keywordtype">double</span>*)(midi_data-&gt;data + buffer_offset) = 12;</div>
<div class="line">buffer_offset += <span class="keyword">sizeof</span>(double);</div>
<div class="line">*(<span class="keywordtype">size_t</span>*)(midi_data-&gt;data + buffer_offset) = 3;</div>
<div class="line">buffer_offset += <span class="keyword">sizeof</span>(size_t);</div>
<div class="line">midi_data-&gt;data[buffer_offset++] = 0x90;</div>
<div class="line">midi_data-&gt;data[buffer_offset++] = 0x48;</div>
<div class="line">midi_data-&gt;data[buffer_offset++] = 0x64;</div>
<div class="line">++midi_data-&gt;event_count;</div>
<div class="line"> </div>
<div class="line">*(<span class="keywordtype">double</span>*)(midi_data-&gt;data + buffer_offset) = 35.5;</div>
<div class="line">buffer_offset += <span class="keyword">sizeof</span>(double);</div>
<div class="line">*(<span class="keywordtype">size_t</span>*)(midi_data-&gt;data + buffer_offset) = 3;</div>
<div class="line">buffer_offset += <span class="keyword">sizeof</span>(size_t);</div>
<div class="line">midi_data-&gt;data[buffer_offset++] = 0x90;</div>
<div class="line">midi_data-&gt;data[buffer_offset++] = 0x55;</div>
<div class="line">midi_data-&gt;data[buffer_offset++] = 0x64;</div>
<div class="line">++midi_data-&gt;event_count;</div>
<div class="line"> </div>
<div class="line">midi_data-&gt;size = buffer_offset;</div>
</div><!-- fragment --><p>This would be done by the host in the case of an input port, and by the plugin in the case of an output port. Whoever is writing events to the buffer must also take care not to exceed the capacity of the data buffer.</p>
<p>To read events from a buffer, you could do something like this: </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> buffer_offset = 0;</div>
<div class="line"><a class="code hl_typedef" href="mid_8cpp.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_variable" href="src_23rdparty_2jack2_2tests_2test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="keywordflow">for</span> (<a class="code hl_variable" href="src_23rdparty_2jack2_2tests_2test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="src_23rdparty_2jack2_2tests_2test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; midi_data-&gt;event_count; ++<a class="code hl_variable" href="src_23rdparty_2jack2_2tests_2test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line">  <span class="keywordtype">double</span> timestamp = *(<span class="keywordtype">double</span>*)(midi_data-&gt;data + buffer_offset);</div>
<div class="line">  buffer_offset += <span class="keyword">sizeof</span>(double);</div>
<div class="line">  <span class="keywordtype">size_t</span> <a class="code hl_variable" href="#a6e8c8c7ef09bf292039f8d8833146277">size</a> = *(<span class="keywordtype">size_t</span>*)(midi_data-&gt;data + buffer_offset);</div>
<div class="line">  buffer_offset += <span class="keyword">sizeof</span>(size_t);</div>
<div class="line">  do_something_with_event(timestamp, <a class="code hl_variable" href="#a6e8c8c7ef09bf292039f8d8833146277">size</a>, </div>
<div class="line">                          midi_data-&gt;data + buffer_offset);</div>
<div class="line">  buffer_offset += <a class="code hl_variable" href="#a6e8c8c7ef09bf292039f8d8833146277">size</a>;</div>
<div class="line">}</div>
<div class="ttc" id="amid_8cpp_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="mid_8cpp.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition</b> mid.cpp:100</div></div>
<div class="ttc" id="asrc_23rdparty_2jack2_2tests_2test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="src_23rdparty_2jack2_2tests_2test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition</b> test.cpp:91</div></div>
<div class="ttc" id="astructLV2__MIDI_html_a6e8c8c7ef09bf292039f8d8833146277"><div class="ttname"><a href="#a6e8c8c7ef09bf292039f8d8833146277">LV2_MIDI::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition</b> lv2-miditype.h:114</div></div>
</div><!-- fragment --> </div><a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="aa562b79a14e26f697116bf2d8494ff46" name="aa562b79a14e26f697116bf2d8494ff46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa562b79a14e26f697116bf2d8494ff46">&#9670;&#160;</a></span>capacity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mid_8cpp.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> LV2_MIDI::capacity</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The size of the data buffer in bytes. It is set by the host and may not be changed by the plugin. The host is allowed to change this between run() calls. </p>

</div>
</div>
<a id="a1f81a74b778729832fd478a268c56682" name="a1f81a74b778729832fd478a268c56682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f81a74b778729832fd478a268c56682">&#9670;&#160;</a></span>data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char* LV2_MIDI::data</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The data buffer that is used to store MIDI events. The events are packed after each other, and the format of each event is as follows:</p>
<p>First there is a timestamp, which should have the type "double", i.e. have the same bit size as a double and the same bit layout as a double (whatever that is on the current platform). This timestamp gives the offset from the beginning of the current cycle, in frames, that the MIDI event occurs on. It must be strictly smaller than the 'nframes' parameter to the current run() call. The MIDI events in the buffer must be ordered by their timestamp, e.g. an event with a timestamp of 123.23 must be stored after an event with a timestamp of 65.0.</p>
<p>The second part of the event is a size field, which should have the type "size_t" (as defined in the standard C header stddef.h). It should contain the size of the MIDI data for this event, i.e. the number of bytes used to store the actual MIDI event. The bytes used by the timestamp and the size field should not be counted.</p>
<p>The third part of the event is the actual MIDI data. There are some requirements that must be followed:</p>
<p>Running status is not allowed. Every event must have its own status byte. Note On events with velocity 0 are not allowed. These events are equivalent to Note Off in standard MIDI streams, but in order to make plugins and hosts easier to write, as well as more efficient, only proper Note Off events are allowed as Note Off. "Realtime events" (status bytes 0xF8 to 0xFF) are allowed, but may not occur inside other events like they are allowed to in hardware MIDI streams. All events must be fully contained in a single data buffer, i.e. events may not "wrap around" by storing the first few bytes in one buffer and then wait for the next run() call to store the rest of the event. If there isn't enough space in the current data buffer to store an event, the event will either have to wait until next run() call, be ignored, or compensated for in some more clever way. All events must be valid MIDI events. This means for example that only the first byte in each event (the status byte) may have the eighth bit set, that Note On and Note Off events are always 3 bytes long etc. The MIDI writer (host or plugin) is responsible for writing valid MIDI events to the buffer, and the MIDI reader (plugin or host) can assume that all events are valid.</p>
<p>On a platform where double is 8 bytes and size_t is 4 bytes, the data buffer layout for a 3-byte event followed by a 4-byte event may look something like this: </p><hr  />
<p> | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | ... |TIMESTAMP 1 |SIZE 1 |DATA |TIMESTAMP 2 |SIZE 2 |DATA | ... </p>

</div>
</div>
<a id="a02c6e454062553934a117206ea56380a" name="a02c6e454062553934a117206ea56380a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02c6e454062553934a117206ea56380a">&#9670;&#160;</a></span>event_count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mid_8cpp.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> LV2_MIDI::event_count</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The number of MIDI events in the data buffer. INPUT PORTS: It's the host's responsibility to set this field to the number of MIDI events contained in the data buffer before calling the plugin's run() function. The plugin may not change this field. OUTPUT PORTS: It's the plugin's responsibility to set this field to the number of MIDI events it has stored in the data buffer before returning from the run() function. Any initial value should be ignored by the plugin. </p>

</div>
</div>
<a id="a6e8c8c7ef09bf292039f8d8833146277" name="a6e8c8c7ef09bf292039f8d8833146277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e8c8c7ef09bf292039f8d8833146277">&#9670;&#160;</a></span>size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mid_8cpp.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> LV2_MIDI::size</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The size of the initial part of the data buffer that actually contains data. INPUT PORTS: It's the host's responsibility to set this field to the number of bytes used by all MIDI events it has written to the buffer (including timestamps and size fields) before calling the plugin's run() function. The plugin may not change this field. OUTPUT PORTS: It's the plugin's responsibility to set this field to the number of bytes used by all MIDI events it has written to the buffer (including timestamps and size fields) before returning from the run() function. Any initial value should be ignored by the plugin. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>plugins/CarlaBase/carla/source/includes/lv2/<a class="el" href="lv2-miditype_8h_source.html">lv2-miditype.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="structLV2__MIDI.html">LV2_MIDI</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
