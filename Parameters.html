<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LMMS: Parameters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LMMS
   </div>
   <div id="projectbrief">Linux MultiMedia Studio - Complete Codebase</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('Parameters.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Parameters </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>parameters management</p>
<p>Main idea:</p>
<p>The host sees the plugin as an atomic entity; and acts as a controller on top of its parameters. The plugin is responsible for keeping its audio processor and its <a class="el" href="namespaceGUI.html">GUI</a> in sync.</p>
<p>The host can at any time read parameters' value on the [main-thread] using <a class="el" href="structclap__plugin__params.html#a9da0058b876ec1be6d811c89dfa25408">clap_plugin_params::value()</a>.</p>
<p>There are two options to communicate parameter value changes, and they are not concurrent.</p><ul>
<li>send automation points during <a class="el" href="structclap__plugin.html#a81c508a9aec5f630e83ac7adac0bade8">clap_plugin.process()</a></li>
<li>send automation points during clap_plugin_params.flush(), for parameter changes without processing audio</li>
</ul>
<p>When the plugin changes a parameter value, it must inform the host. It will send <a class="el" href="clap_2events_8h.html#aff5dc66893c91de9e763d8ded59de8dda8c620b7b133ff34166c48c842881ec8a">CLAP_EVENT_PARAM_VALUE</a> event during process() or flush(). If the user is adjusting the value, don't forget to mark the begining and end of the gesture by sending CLAP_EVENT_PARAM_GESTURE_BEGIN and CLAP_EVENT_PARAM_GESTURE_END events.</p>
<dl class="section note"><dt>Note</dt><dd>MIDI CCs are tricky because you may not know when the parameter adjustment ends. Also if the host records incoming MIDI CC and parameter change automation at the same time, there will be a conflict at playback: MIDI CC vs Automation. The parameter automation will always target the same parameter because the param_id is stable. The MIDI CC may have a different mapping in the future and may result in a different playback.</dd></dl>
<p>When a MIDI CC changes a parameter's value, set the flag CLAP_EVENT_DONT_RECORD in clap_event_param.header.flags. That way the host may record the MIDI CC automation, but not the parameter change and there won't be conflict at playback.</p>
<p>Scenarios:</p>
<p>I. Loading a preset</p><ul>
<li>load the preset in a temporary state</li>
<li>call clap_host_params.rescan() if anything changed</li>
<li>call clap_host_latency.changed() if latency changed</li>
<li>invalidate any other info that may be cached by the host</li>
<li>if the plugin is activated and the preset will introduce breaking changes (latency, audio ports, new parameters, ...) be sure to wait for the host to deactivate the plugin to apply those changes. If there are no breaking changes, the plugin can apply them them right away. The plugin is resonsible for updating both its audio processor and its gui.</li>
</ul>
<p>II. Turning a knob on the DAW interface</p><ul>
<li>the host will send an automation event to the plugin via a process() or flush()</li>
</ul>
<p>III. Turning a knob on the <a class="el" href="classPlugin.html">Plugin</a> interface</p><ul>
<li>the plugin is responsible for sending the parameter value to its audio processor</li>
<li>call clap_host_params-&gt;request_flush() or clap_host-&gt;request_process().</li>
<li>when the host calls either clap_plugin-&gt;process() or clap_plugin_params-&gt;flush(), send an automation event and don't forget to set begin_adjust, end_adjust and should_record flags</li>
</ul>
<p>IV. Turning a knob via automation</p><ul>
<li>host sends an automation point during clap_plugin-&gt;process() or clap_plugin_params-&gt;flush().</li>
<li>the plugin is responsible for updating its <a class="el" href="namespaceGUI.html">GUI</a></li>
</ul>
<p>V. Turning a knob via plugin's internal MIDI mapping</p><ul>
<li>the plugin sends a CLAP_EVENT_PARAM_SET output event, set should_record to false</li>
<li>the plugin is responsible to update its <a class="el" href="namespaceGUI.html">GUI</a></li>
</ul>
<p>VI. Adding or removing parameters</p><ul>
<li>if the plugin is activated call clap_host-&gt;restart()</li>
<li>once the plugin isn't active:<ul>
<li>apply the new state</li>
<li>if a parameter is gone or is created with an id that may have been used before, call clap_host_params.clear(host, param_id, CLAP_PARAM_CLEAR_ALL)</li>
<li>call clap_host_params-&gt;rescan(CLAP_PARAM_RESCAN_ALL) </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
